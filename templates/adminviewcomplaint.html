{% include 'adminheader.html' %}
<center>
		<div class="fullwidthbanner" id="home">
            <div class="tp-banner">
                <ul>
                    <!-- SLIDE 1 -->
                    <li data-transition="fade" data-slotamount="7" data-masterspeed="1500">
                        <!-- MAIN IMAGE -->
                        <img src="/static/images/bg-1.jpg" alt="desk" data-bgfit="cover" data-bgposition="left top" data-bgrepeat="no-repeat">
                        <!-- LAYERS -->
                        <!-- LAYER NR. 1 -->
                        <div class="tp-caption slider-title" data-x="center" data-y="center"  data-voffset="-30" data-speed="500" data-start="1200" data-easing="Power4.easeInOut">
<h1 style="padding-top: 100px">View Complaints</h1>
<!-- Text search -->
<input
  type="text"
  id="searchInput"
  class="form-control"
  placeholder="Search complaints..."
  style="width: 300px; margin-bottom: 10px; font-size: 16px; display: inline-block;">

<!-- Date filter -->
<input
  type="date"
  id="dateInput"
  class="form-control"
  style="width: 200px; margin-left: 10px; margin-bottom: 10px; font-size: 16px; display: inline-block;">

<table class="table" style="width: 500px;font-size:20px">
	<tr>
		<th>Customer Name</th>
		<th>Complaint</th>
		<th>Reply</th>
		<th>Date</th>
	</tr>
	{% for row in data['complaint'] %}
	<tr>
		<td>{{row['firstname']+" "+row['lastname']}}</td>
		<td>{{row['complaint']}}</td>
		<td>{{row['reply']}}</td>
		<td>{{row['date']}}</td>
		{% if row['reply']=="pending" %}
		<td><a href="adminsendreply?cid={{row['complaint_id']}}" class="btn btn-info">Send Reply</a></td>
		{% endif %}
	</tr>
	{% endfor %}
</table>
</center>
                        </div> <!-- /tp-caption -->
                        <!-- LAYER NR. 2 -->
                       
                    </li>
                    <!-- SLIDE 2 -->
                    
                </ul>
            </div>
        </div><!--full width banner-->

{% include 'footer.html' %}


<script>
  const searchInput = document.getElementById('searchInput');
  const dateInput = document.getElementById('dateInput');
  const rows = document.querySelectorAll('table.table tr');

  function filterTable() {
    const searchText = searchInput.value.toLowerCase();
    const selectedDate = dateInput.value; // format: "YYYY-MM-DD"

    for (let i = 1; i < rows.length; i++) { // skip header
      const row = rows[i];
      const rowText = row.innerText.toLowerCase();
      const dateCellText = row.cells[3].innerText; // Date column

      // Check if text matches anywhere in the row
      const matchesSearch = rowText.includes(searchText);

      // Check if date matches or if no date selected (show all)
      const matchesDate = !selectedDate || dateCellText === selectedDate;

      row.style.display = (matchesSearch && matchesDate) ? '' : 'none';
    }
  }

  searchInput.addEventListener('keyup', filterTable);
  dateInput.addEventListener('change', filterTable);
</script>