{% include 'employeeheader.html' %}
<center>
		<div class="fullwidthbanner" id="home">
            <div class="tp-banner">
                <ul>
                    <!-- SLIDE 1 -->
                    <li data-transition="fade" data-slotamount="7" data-masterspeed="1500">
                        <!-- MAIN IMAGE -->
                        <img src="/static/images/bg-1.jpg" alt="desk" data-bgfit="cover" data-bgposition="left top" data-bgrepeat="no-repeat">
                        <!-- LAYERS -->
                        <!-- LAYER NR. 1 -->
                        <div class="tp-caption slider-title" data-x="center" data-y="center"  data-voffset="-30" data-speed="500" data-start="1200" data-easing="Power4.easeInOut">
<form>
	<h1 style="padding-top: 150px">View Loan Requests</h1>
	<div style="overflow-x: auto;width: 1200px">
		<!-- Search Filters -->
<input type="text" id="customerNameSearch" class="form-control" placeholder="Search by Customer Name"
  style="width: 200px; display: inline-block; margin: 5px; font-size: 13px;">

<input type="text" id="pincodeSearch" class="form-control" placeholder="Search by Pincode"
  style="width: 150px; display: inline-block; margin: 5px; font-size: 13px;">

<input type="text" id="loanNameSearch" class="form-control" placeholder="Search by Loan Name"
  style="width: 180px; display: inline-block; margin: 5px; font-size: 13px;">

<input type="text" id="amountSearch" class="form-control" placeholder="Search by Max Amount"
  style="width: 180px; display: inline-block; margin: 5px; font-size: 13px;">

<select id="statusFilter" class="form-control"
  style="width: 180px; display: inline-block; margin: 5px; font-size: 13px;">
  <option value="all">All Statuses</option>
  <option value="approved">Approved</option>
  <option value="rejected">Rejected</option>
  <option value="pending">Pending</option>
</select>

	<table class="table" style="width: 600px;font-size:10px">
	<tr>
		<th>Customer Name</th>
		<th>HouseName</th>
		<th>Customer Place</th>
		<th>Phone</th>
		<th>Email</th>
		<th>BankName</th>
		<th>BankPlace</th>
		<th>Loan Name</th>
		<th>Details</th>
		<th>Interest Rate</th>
		<th>Max Amount</th>
		<th>Datetime</th>
		<th>Status</th>
	</tr>
	{% for row in data['request'] %}
	<tr>
		<td>{{row['firstname']+" "+row['lastname']}}</td>
		<td>{{row['housename']}}</td>
		<td>{{row['customerplace']}}</td>
		<td>{{row['customerphone']}}</td>
		<td>{{row['customeremail']}}</td>
		<td>{{row['bankname']}}</td>
		<td>{{row['bankplace']}}</td>
		<td>{{row['loan_name']}}</td>
		<td>{{row['details']}}</td>
		<td>{{row['interest_rate']}}</td>
		<td>{{row['max_amount']}}</td>
		<td>{{row['datetime']}}</td>
		<td>{{row['status']}}</td>
		{% if row['status']=="pending" %}
		<td>
		<a href="employeeupdateloanstatus?rid={{row['request_id']}}">update status</a></td>
		{% endif %}
	</tr>
	{% endfor %}
</table>
</div>
</form>
</center>
                        </div> <!-- /tp-caption -->
                        <!-- LAYER NR. 2 -->
                       
                    </li>
                    <!-- SLIDE 2 -->
                    
                </ul>
            </div>
        </div><!--full width banner-->
{% include 'footer.html' %}

<script>
  const customerInput = document.getElementById("customerNameSearch");
  const pincodeInput = document.getElementById("pincodeSearch");
  const loanNameInput = document.getElementById("loanNameSearch");
  const amountInput = document.getElementById("amountSearch");
  const statusFilter = document.getElementById("statusFilter");
  const rows = document.querySelectorAll("table.table tr");

  function filterTable() {
    const customerValue = customerInput.value.toLowerCase();
    const pincodeValue = pincodeInput.value.toLowerCase();
    const loanNameValue = loanNameInput.value.toLowerCase();
    const amountValue = amountInput.value.toLowerCase();
    const statusValue = statusFilter.value.toLowerCase();

    for (let i = 1; i < rows.length; i++) { // skip header
      const row = rows[i];
      const cells = row.getElementsByTagName("td");

      const customerName = cells[0]?.innerText.toLowerCase();  // Customer Name
      const pincode = cells[4]?.innerText.toLowerCase();       // Email column (assuming pincode not shown; adjust index if needed)
      const loanName = cells[7]?.innerText.toLowerCase();      // Loan Name
      const maxAmount = cells[10]?.innerText.toLowerCase();    // Max Amount
      const status = cells[12]?.innerText.toLowerCase();       // Status

      const matchCustomer = customerName.includes(customerValue);
      const matchPincode = pincode.includes(pincodeValue);
      const matchLoan = loanName.includes(loanNameValue);
      const matchAmount = maxAmount.includes(amountValue);
      const matchStatus = (statusValue === "all" || status === statusValue);

      const visible = matchCustomer && matchPincode && matchLoan && matchAmount && matchStatus;
      row.style.display = visible ? "" : "none";
    }
  }

  customerInput.addEventListener("input", filterTable);
  pincodeInput.addEventListener("input", filterTable);
  loanNameInput.addEventListener("input", filterTable);
  amountInput.addEventListener("input", filterTable);
  statusFilter.addEventListener("change", filterTable);
</script>
